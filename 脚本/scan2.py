m={}

#获得一个smali的api
def getApi(file):
	global m
	if file[-5:]!="smali":
		return
	f=open(file)
	lines=f.readlines()
	f.close()
	for line in lines:
		if line.find("invoke")!=-1:
			# print(line.split(",")[-1])
			s=line.split(",")[-1][:-1]
			if s not in m.keys():
				m[s]=1
			else:
				m[s]+=1



import os




def write():
	global m
	f=open("api_times.txt",'w')
	for key,value in m.items():
		f.write(str(key)+"\n"+str(value)+"\n")
	f.close()


dir1="origin"
for path,dir,files in os.walk(dir1):
	if path.find("smali")!=-1:
		print(path)
		for file in files:
			getApi(path+'/'+file)
write()

